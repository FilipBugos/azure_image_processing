# Docs for the Azure Web Apps Deploy action: https://github.com/Azure/webapps-deploy
# More GitHub Actions for Azure: https://github.com/Azure/actions

name: Test

on:
  workflow_dispatch:

jobs:
  get-publish-profiles:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4.7.1

      - name: run pip
        run: pip install azure-identity && pip install requests

      - name: run script
        env: 
          AZURE_TENANT_ID: ${{ secrets.AZURE_TENANT_ID }}
          AZURE_CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }}
          AZURE_CLIENT_SECRET: ${{ secrets.AZURE_CLIENT_SECRET }}
          AZURE_SUBS_ID: ${{ secrets.AZURE_SUBS_ID }}
          WEB_APP_NAME: ${{ secrets.WEB_APP_NAME }}
          WEB_APP_RESOURCE_GROUP_NAME: ${{ secrets.WEB_APP_RESOURCE_GROUP_NAME }}
        run: python ./.github/scripts/importPublishProfile.py

      - name: github env
        run: cat $GITHUB_ENV
